
SELECT s.user_lyft_id,
    s.started_at AS occurred_at,
    count(distinct(CASE WHEN s.destinations_set > 0 THEN s.session_id END)) AS metric_numerator,
    count(distinct s.session_id) AS metric_denominator
FROM hive.redshift.dimension_session_stats s
WHERE s.valid_pax_session = TRUE
    AND s.user_lyft_id IS NOT NULL
    AND s.ds >= '2019-04-18'
group by 1,2




